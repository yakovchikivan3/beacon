<body>
    <beacons-tag></beacons-tag>
    <div id="root"></div>

    <button id="installButton" style="display: none; padding: 20px 80px; font-size: 16px; background-color: #6200ea; color: white; border: none; cursor: pointer;">
    üì≤–í—Å—Ç–∞–Ω–æ–≤–∏—Ç–∏ –∑–∞—Å—Ç–æ—Å—É–Ω–æ–∫
</button>

<!-- –†–µ—î—Å—Ç—Ä–∞—Ü—ñ—è Service Worker -->
<script>
    if ('serviceWorker' in navigator) {
        navigator.serviceWorker.register('/pwabuilder-sw.js')
            .then((registration) => {
                console.log('‚úÖ Service Worker –∑–∞—Ä–µ—î—Å—Ç—Ä–æ–≤–∞–Ω–æ:', registration);
            })
            .catch((error) => {
                console.error('‚ùå –ü–æ–º–∏–ª–∫–∞ —Ä–µ—î—Å—Ç—Ä–∞—Ü—ñ—ó Service Worker:', error);
            });
    }
</script>

<!-- –ö–æ–¥ –¥–ª—è PWA -->
<script>
    let deferredPrompt;

    window.addEventListener("beforeinstallprompt", (event) => {
        console.log("‚úÖ beforeinstallprompt —Å–ø—Ä–∞—Ü—é–≤–∞–ª–æ!");
        event.preventDefault();
        deferredPrompt = event;

        // –ü–æ–∫–∞–∑—É—î–º–æ –∫–Ω–æ–ø–∫—É –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è PWA
        let installButton = document.getElementById("installButton");
        if (installButton) {
            installButton.style.display = "block";
        }
    });

    // –û–±—Ä–æ–±–Ω–∏–∫ –∫–ª—ñ–∫—É –Ω–∞ –∫–Ω–æ–ø–∫—É "–í—Å—Ç–∞–Ω–æ–≤–∏—Ç–∏ –∑–∞—Å—Ç–æ—Å—É–Ω–æ–∫"
    document.getElementById("installButton").addEventListener("click", () => {
        if (deferredPrompt) {
            console.log("üü¢ –í–∏–∫–ª–∏–∫–∞—î–º–æ prompt()...");
            deferredPrompt.prompt();
            deferredPrompt.userChoice.then((choiceResult) => {
                console.log(choiceResult.outcome === "accepted" ? "‚úÖ –ö–æ—Ä–∏—Å—Ç—É–≤–∞—á –≤—Å—Ç–∞–Ω–æ–≤–∏–≤ PWA" : "‚ùå –ö–æ—Ä–∏—Å—Ç—É–≤–∞—á –≤—ñ–¥–º–æ–≤–∏–≤—Å—è");
                deferredPrompt = null;
            });
        } else {
            console.log("‚ùå –í—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è PWA –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–µ");
        }
    });

    // –ü—ñ–¥–∫–ª—é—á–∞—î–º–æ—Å—è –¥–æ –∫–Ω–æ–ø–∫–∏ "–†–µ—î—Å—Ç—Ä–∞—Ü—ñ—è"
    document.addEventListener("DOMContentLoaded", () => {
        let registerButton = document.querySelector(".css-f9dlpb");

        if (registerButton) {
            console.log("‚úÖ –ö–Ω–æ–ø–∫–∞ '–†–µ—î—Å—Ç—Ä–∞—Ü—ñ—è' –∑–Ω–∞–π–¥–µ–Ω–∞!");

            registerButton.addEventListener("click", (event) => {
                event.preventDefault();
                console.log("üü¢ –ö–Ω–æ–ø–∫—É '–†–µ—î—Å—Ç—Ä–∞—Ü—ñ—è' –Ω–∞—Ç–∏—Å–Ω—É—Ç–æ");

                if (deferredPrompt) {
                    console.log("üü¢ –í–∏–∫–ª–∏–∫–∞—î–º–æ prompt()...");
                    deferredPrompt.prompt();
                    deferredPrompt.userChoice.then((choiceResult) => {
                        console.log(choiceResult.outcome === "accepted" ? "‚úÖ –ö–æ—Ä–∏—Å—Ç—É–≤–∞—á –≤—Å—Ç–∞–Ω–æ–≤–∏–≤ PWA" : "‚ùå –ö–æ—Ä–∏—Å—Ç—É–≤–∞—á –≤—ñ–¥–º–æ–≤–∏–≤—Å—è");
                        deferredPrompt = null;
                    });
                } else {
                    console.log("üî¥ PWA –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–µ, –≤—ñ–¥–∫—Ä–∏–≤–∞—î–º–æ –ø–æ—Å–∏–ª–∞–Ω–Ω—è...");
                    window.location.href = registerButton.href;
                }
            });
        } else {
            console.log("‚ùå –ö–Ω–æ–ø–∫—É '–†–µ—î—Å—Ç—Ä–∞—Ü—ñ—è' –Ω–µ –∑–Ω–∞–π–¥–µ–Ω–æ, –ø–µ—Ä–µ–≤—ñ—Ä –∫–ª–∞—Å!");
        }
    });
</script>
</body>
</html>

